var argv=require("yargs").argv,autoprefixer=require("gulp-autoprefixer"),chalk=require("chalk"),cleanCSS=require("gulp-clean-css"),clear=require("clear"),coffee=require("gulp-coffee"),concat=require("gulp-concat"),del=require("del"),fs=require("fs"),fssync=require("fs-sync"),gulp=require("gulp"),insert=require("gulp-insert"),jshint=require("gulp-jshint"),jsValidate=require("gulp-jsvalidate"),lazyPipe=require("lazypipe"),less=require("gulp-less"),lessPluginAutoPrefix=require("less-plugin-autoprefix"),lessAutoprefix=new lessPluginAutoPrefix({browsers:["last 2 versions"]}),nop=require("gulp-nop"),path=require("path"),rename=require("gulp-rename"),sass=require("gulp-sass"),sourcemaps=require("gulp-sourcemaps"),stylefmt=require("gulp-stylefmt"),through=require("through2"),ts=require("gulp-typescript"),uglify=require("gulp-uglify"),uglifyJs=require("uglify-js"),wait=require("gulp-wait"),config=getConfig(),SERVICES={d:"del",del:"autodel",mj:"minjs",minjs:"automin",ts:"typescript",c:"coffee",coffee:"coffeescript",l:"less",less:"less",s:"sass",sass:"sass",mc:"mincss",mincss:"autominCss",tr:"transitive",a:"all",all:"automin autodel typescript coffeescript autominCss less sass",st:"style",style:"autominCss less sass",jvs:"autodel automin",tps:"typescript",typescript:"autodel automin typescript",cof:"coffeescript",coffeescript:"autodel automin coffeescript"},PRESET_OPTIONS="all|style|js|typescript|coffeescript",SERVICES_OPTIONS="del|minjs|ts|coffee|less|sass|mincss",SERVICES_ADVANCED_OPTIONS="transitive",GLOUPS_VERSION="4.5",ALL_SERVICES_OPTIONS=PRESET_OPTIONS+"|"+SERVICES_OPTIONS+"|"+SERVICES_ADVANCED_OPTIONS,JS_REGEX_FILE_PATH_PATTERN="^(?:((?:[^\\.]+|..)[\\x2F\\x5C])|)((?:([^\\.^\\x2F^\\x5C]+)(?:((?:[.](?!\\bmin\\b)(?:[^\\.]+))+|))(?:([.]min)([.]js)|([.]js))))$",GLOUPS_OPTIONS=SERVICES_OPTIONS+"|"+PRESET_OPTIONS,SILENT_TASKS="watch|vet|unit-test|integration-test",ISALL=!0,isdist={},AUTOPREFIXER_BROWSERS=["> 1%","last 2 versions","firefox >= 4","safari 7","safari 8","IE 8","IE 9","IE 10","IE 11"];String.prototype.format=function(s){return this.replace(String.prototype.format.regex,function(e){var t=parseInt(e.substring(1,e.length-1));return 0<=t?s[t]:-1===t?"{":-2===t?"}":""})},String.prototype.format.regex=new RegExp("{-?[0-9]+}","g"),String.prototype.hackSlashes=function(){return this.replace(/[\\]/g,"/")};var cmd=String(process.argv[2]);if(ISALL||new RegExp("^(({0})(:.*)?)$".format([SILENT_TASKS])).test(cmd)){var isWatching=/^(watch:.*)$/.test(cmd),firstCall=!1,on=gulp.on;gulp.on=function(e,t){if(!/^(task_start|task_stop)$/.test(e)||!/gutil\.log\(\s*'(Starting|Finished)/.test(t.toString()))return on.apply(gulp,arguments)},gulp.on("start",function(){firstCall&&(isWatching&&process.stdout.write("c"),firstCall=!1)}),gulp.on("stop",function(){firstCall=!0})}gulp.task("default",["setParams"]),gulp.task("clear",function(){clear()}),gulp.task("setVars",function(){for(var e in setConfig(),config.verbose||logTaskPurpose(this.currentTask.name),config.projects){var t=config.projects[e];fssync.exists(t.path+"\\config.mzg.json")?(console.log("{0} - OK".format([chalk.green(t.project)])),t.checked&&setUpProjectWatchingPaths(t.path)):logProjectErrored(t)}for(e in config.pathesToSass){var s=config.pathesToSass[e].watch;mappSassMatching(config.pathesToSass[e].projectPath,s)}isdist.NOT_DISTRIBUTION&&(config.verbose||console.log(forNowLongLog("{0}\n",["config externalized under config.json"])),gulp.start("externalizeConfig")),config.verbose||(console.log(forNowLongLog("{0}\n",["config externalized under config.json"])),console.log(forNowLongLog("{0}\n",["CONFIGURATON PROCEEDED"])))}),gulp.task("setParams",function(){var e,t=this.seq.slice(-1)[0];if(/^default$/.test(t))e=tasksToRunOnArgvs(),gulp.start(0<e.length?["setVars"].concat(e):[]);else if(/^serve$/.test(t))e=tasksToRunOnArgvs(),gulp.start(0<e.length?["setVars"].concat(e):[]);else if(/^rewrite$/.test(t)){var s=configurationOfRewriteOnArvs(),o=!/^ugly$/.test(s.uglyness),i=!/^multiple$/.test(s.times);logTaskName((o?"imBeauty":"imUgly")+(i?"AtOnce":"imBeauty")),mergingOnChanges(o,i),(o?logTaskEndBeauy:logTaskEndUgly)(i)}}),gulp.task("jshint",function(){return gulp.src(config.pathesToJs).pipe(jshint()).pipe(jshint.reporter("jshint-stylish"))}),gulp.task("helpMe",function(){logHelp()}),gulp.task("scanProjects",function(){logTaskPurpose(this.currentTask.name),setConfig(),config.projects.forEach(function(e){fssync.exists(e.path+"\\config.mzg.json")||(console.log("file :"+logFilePath(e.path+"\\config.mzg.json")+" does not exist ... creation very soon"),gulp.src("custom/config_model.json").pipe(rename("config.mzg.json")).pipe(gulp.dest(e.path)))})}),gulp.task("serviceMapping",function(){logTaskPurpose(this.currentTask.name),config.verbose=!0,gulp.start(["setVars"])}),gulp.task("serve",["setParams"]),gulp.task("automin",function(){logTaskPurpose(this.currentTask.name);var e=watchList(config.pathesToJs);gulp.watch(e,function(e){var t=new RegExp(JS_REGEX_FILE_PATH_PATTERN,"g").exec(e.path);if(!/.*.min.js$/.test(e.path)&&t){var s=getMatchingEntryConfig(e.path,config.pathesToJs),o=s.sourcemaps;gulp.src(e.path).pipe(sourcemapInit(o)).pipe(uglify()).pipe(renameSuffixMin()).pipe(insertSignatureAfter("Compressed","gulp-uglify")).pipe(sourcemapWrite(o)).pipe(gulp.dest(s.dest)),console.log(forNowShortLog("Compressed file version updated/created here :\n{0} > {1}",[breath(),logFilePath(s.dest)]))}},jshint)}),gulp.task("autodel",function(e){logTaskPurpose(this.currentTask.name);var t=watchList(config.pathesToJs);gulp.watch(t,function(e){var t=new RegExp(JS_REGEX_FILE_PATH_PATTERN,"g").exec(e.path);if("deleted"===e.type&&t){logProcessCompleteOnFile([t[2].replace(/.js$/g,".min.js")],"deleted",function(){var s=getMatchingEntryConfig(e.path,config.pathesToJs),o=(s+"/"+t[2]).replace(/.min.js$/g,".js").replace(/.js$/g,".min.js");fs.stat(o,function(e,t){e||del(o,{force:!0}),console.log(forNowShortLog("source folder here :\n{0}> {1}",[breath(),logFilePath(s)]))})})}},jshint)}),gulp.task("mergeAllMinified",function(){gulp.watch(config.pathesToJs,function(){gulp.src(config.pathesToJs+"/scirpt/*.min.js").pipe(concat("js_stack.min.js")).pipe(uglify()).pipe(gulp.dest("../uglified"))})}),gulp.task("typescript",function(){logTaskPurpose(this.currentTask.name);var e=watchList(config.pathesToTs);gulp.watch(e,function(e){var t=getMatchingEntryConfig(e.path,config.pathesToTs),s=t.sourcemaps;gulp.src(e.path).pipe(sourcemapInit(s)).pipe(typescripting(t.dest)).pipe(insertSignatureAfter("Compiled","gulp-typescript")).pipe(sourcemapWrite(s)).pipe(gulp.dest(t.dest)),console.log(forNowShortLog("Compressed file version updated/created here :\n{0}> {1}",[breath(),logFilePath(t.dest)]))})});coffee=require("gulp-coffee");function renameSuffixMin(){return rename({suffix:".min"})}function cleanCssMinification(){return cleanCSS({compatibility:"ie8"})}function typescripting(e){return ts({noImplicitAny:!0})}function insertSignatureAfter(e,t){return insert.append("\n/* -- {0} with Gloups {1} | {2} using -- */".format([e,GLOUPS_VERSION,t]))}function sourcemapInit(e){return(e?sourcemaps.init:nop)()}function sourcemapWrite(e){return e?sourcemaps.write("./"):nop()}function autoprefix(){return autoprefixer({browsers:AUTOPREFIXER_BROWSERS,cascade:!1})}function serveCoffee(){return coffee({bare:!0})}function makeLess(){return less({paths:[path.join(__dirname,"less","includes")]})}function transitivitySetup(r,l,c){return through.obj(function(e,t,s){var o=metAllArgs(["all","transitive"])||metAllArgs(["sass","mincss","transitive"])||metAllArgs(["less","mincss","transitive"]),i=!1;if(r.dest=l.dest,o){var n=/^.*[\/](.*)$/g.exec(c.hackSlashes())[1],a=getMatchingEntryConfig("{0}/{1}".format([l.dest,n]),config.pathesToStyle);i=null!=a,(r.should=i)&&(r.compressing=cleanCssMinification,r.suffixing=renameSuffixMin,r.dest=a.dest)}s(null,e)})}function transitiveWrapAround(e,t,s,o){return lazyPipe().pipe(transitivitySetup,e,t,s).pipe(o).pipe(e.compressing).pipe(e.suffixing)}function setSourceMappingAndSign(e,t,s){var o=t.sourcemaps;return lazyPipe().pipe(sourcemapInit,o).pipe(e).pipe(insertSignatureAfter,s.action,s.module).pipe(sourcemapWrite,o)}function appendFilesToLog(o,e,t){gulp.src(t.path).pipe(through.obj(function(e,t,s){--o.k,o.files.push(e.path),s(null,e)})).pipe(e()).pipe(wait(500)).on("end",function(){0==++o.k&&(console.log(forNowShortLog(o.txt,[])),o.files.forEach(function(e,t){console.log(logFilePath(e.hackSlashes()))}),console.log(),o.files=[])})}function consumePipeProcss(e,t,s,o){var i=getMatchingEntryConfig(s,config.pathesToStyleLess),n=setSourceMappingAndSign(transitiveWrapAround(e,i,s,t),i,o);gulp.src(s).pipe(n()).pipe(gulp.dest(e.dest)),console.log(forNowShortLog("Processed file version updated/created here :\n{0}> {1}",[breath(),logFilePath(i.dest)]))}function getConfig(){return config||{verbose:!1,pathesToJs:[],pathesToTs:[],pathesToCoffee:[],pathesToStyle:[],pathesToStyleLess:[],pathesToSass:[],projects:[]}}function readJsonConfig(e){var t,s,o=fs.readFileSync(e,"utf8"),i=new classReading;i.initialize(o,0);var n=0,a=!0,r="",l=(t=/^(.*)(\.json)$/.exec(e))[1]+".temp"+t[2];fssync.write(l,"","utf8"),i.readLines(function(){s=i.getLine(),(a=t=/^(.*)\/\/.*$/g.exec(s))?r=t[1]:(a=t=/^(.*)\/\*$/g.exec(s))?(r=t[1],++n):(a=t=/^.*\*\/(.*)$/g.exec(s))?(r=t[1],--n):(a=0==n)&&(r=s),a&&(/^[\s]*$/g.test(r)||fs.appendFileSync(l,r+"\r\n","utf8"))});var c=fs.readFileSync(l,"utf8");return fssync.remove(l),JSON.parse(c)}function setConfig(){config.projects=readJsonConfig("custom/config.json").projects}function makePathesCoveringAllFilesFor(e,t,s,o){var i=t.addon,n=t.pathesToService;if(i){for(var a=0,r=i.length;a<r;++a){i[a].watch=i[a].watch+s;i[a].watch,i[a].dest;0<a&&(o="[SAME-PURPOSE]"),logServiceActivatedPushed(o,e,i[a]),i[a].watch=e+"/"+i[a].watch,i[a].dest=e+"/"+i[a].dest,t.projectPath&&(i[a].projectPath=e),n=n.concat(i[a])}config.verbose&&console.log()}return n}function setUpProjectWatchingPaths(e){var t=readJsonConfig(e+"/config.mzg.json");console.log("Activated Services for target project under the path [FOLDER]:"),console.log(logFilePath(e)+"\n"),config.pathesToJs=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToJs,addon:t.minify_js},"/**/*.js","Compress .js files into .min.js files"),config.pathesToTs=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToTs,addon:t.ts_to_js},"/**/*.ts","Compile .ts files into .js file"),config.pathesToCoffee=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToCoffee,addon:t.coffee_to_js},"/**/*.coffee","Compile .coffee files into .js file"),config.pathesToStyle=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToStyle,addon:t.minify_css},"/**/*.css","Compress .css files"),config.pathesToStyleLess=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToStyleLess,addon:t.less},"/**/*.less","Compile .less files into .css files"),config.pathesToSass=makePathesCoveringAllFilesFor(e,{projectPath:e,pathesToService:config.pathesToSass,addon:t.sass},"/**/*.scss","Compile .scss files into .css files")}function getMatchingEntryConfig(e,t){for(var s in e=e.hackSlashes(),t){var o=t[s],i=o.watch.hackSlashes(),n=(o.dest.hackSlashes(),new RegExp("^([^\\\\/*]+).([^\\*]+)([\\/]?[\\/*]+[\\/]?)(.*)$","g").exec(i)[2]);if(new RegExp("^.*(?:"+n+").*$","g").exec(e))return o}return null}function watchList(e){var t=[];for(var s in e){var o=e[s].watch;t.push(o)}return t}function mappSassMatching(t,e){var s;if((s=/^(.*)[\\\/]\*\*[\\\/]\*\..*$/.exec(e))&&s[1]){config.sassMaching=[];var o=walkSync(s[1],[],new RegExp("^.*[\\/](_.*)$","i")),i=0;o.forEach(function(e){config.sassMaching.push({identifier:e.fileName,target:e.path,partials:[]}),pushEllipsizedPartials(t,e,i++)})}}function pushEllipsizedPartials(e,s,o){var i=new classReading,t=fs.readFileSync(s.path,"utf8");i.initialize(t,0);var n,a,r=e.length;i.readLines(function(){if(n=i.getLine(),(a=/^@import[\s].*["](.*)["]/.exec(n))&&a[1]){var e="{0}/{1}".format([s.dir,a[1]]),t=pathEllipzizeing(e,0,e.substr(r).split("/").length);config.sassMaching[o].partials.push(t)}})}function pathEllipzizeing(e,t,s){var o="^(?:(?:((?:[^/\\]+[\\/]{-1}1,2{-2}){-1}{0}{-2}).*((?:[\\/][^/\\?]+){-1}{1},{-2}[\\/]?)[^?]*).*|([^?]*).*)$".format([t,s]),i=new RegExp(o,"g").exec(e);return i[3]?i[3]:i[1]+"..."+i[2]}gulp.task("coffeescript",function(){logTaskPurpose(this.currentTask.name);var e=watchList(config.pathesToCoffee);gulp.watch(e,function(e){var t=getMatchingEntryConfig(e.path,config.pathesToCoffee),s=t.sourcemaps;gulp.src(e.path).pipe(sourcemapInit(s)).pipe(serveCoffee()).pipe(insertSignatureAfter("Served coffee","gulp-coffee")).pipe(sourcemapWrite(s)).pipe(gulp.dest(t.dest)),console.log(forNowShortLog("Compiled file version updated/created here :\n{0}> {1}",[breath(),logFilePath(t.dest)]))})}),gulp.task("autominCss",function(){logTaskPurpose(this.currentTask.name);var i=getOneFeedBackForAll("Are compressed: \n"),e=watchList(config.pathesToStyle);gulp.watch(e,function(e){if("deleted"!==e.type&&!/^(.*.min.css|.*.less|.*.scss|.*.map)$/.test(e.path)&&/^.*.css$/.test(e.path)){var t=lazyPipe().pipe(autoprefix).pipe(cleanCssMinification).pipe(renameSuffixMin),s=getMatchingEntryConfig(e.path,config.pathesToStyle),o=setSourceMappingAndSign(t,s,{action:"Compressed",module:"gulp-clean-css"}).pipe(function(){return gulp.dest(s.dest)});appendFilesToLog(i,o,e)}})}),gulp.task("autoformatCss",function(){gulp.watch(config.pathesToStyleLess,function(e){/^(.*.min.css)$/.test(e.path)||(console.log("try"),gulp.src(e.path).pipe(cssbeautify({format:"beautify"})).pipe(gulp.dest(function(e){return e.base})),console.log("done"))})}),gulp.task("less",function(){logTaskPurpose(this.currentTask.name);var e=watchList(config.pathesToStyleLess),s=getFreshTransitivity();gulp.watch(e,function(e){if(/.*.less$/.test(e.path)){var t=lazyPipe().pipe(function(){return sass(less({plugins:[lessAutoprefix]}))}).pipe(autoprefix).pipe(stylefmt);consumePipeProcss(s,t,e.path,{action:"Processed",module:"gulp-less"})}})}),gulp.task("sass",function(){logTaskPurpose(this.currentTask.name);var e=watchList(config.pathesToSass),n=getFreshTransitivity();gulp.watch(e,function(s){if(/.*.scss$/.test(s.path)){var o={action:"Processed",module:"gulp-sass"},i=getMatchingEntryConfig(s.path,config.pathesToSass);realTargets=getMatchingPrincipalSCSS(i.projectPath,s.path.hackSlashes());logProcessCompleteOnFile(realTargets,"Processing",function(){var e=lazyPipe().pipe(function(){return sass({indentedSyntax:!1}).on("error",sass.logError)}).pipe(autoprefix).pipe(stylefmt),t=setSourceMappingAndSign(transitiveWrapAround(n,i,s.path,e),i,o);gulp.src(realTargets).pipe(t()).pipe(gulp.dest(n.dest))})}})}),gulp.task("writeDist",function(){var s=new Date;gulp.src(distFiles).pipe(jsValidate())&&gulp.src(distFiles).pipe(concat(gulpFileTempPath2)).pipe(uglify()).pipe(gulp.dest(function(e){var t=ms2Time(new Date-s);return console.log(forNowShortLog("{0} writen after {1}",[logFilePath(gulpFileTempPath2),chalk.magenta(t)])),getGulpfolderFromFileBase(e)}))}),gulp.task("rewrite",["setParams","applyTemp","applyDist"]),gulp.Gulp.prototype.__runTask=gulp.Gulp.prototype._runTask,gulp.Gulp.prototype._runTask=function(e){this.currentTask=e,this.__runTask(e)};var walkSync=function(t,s,o){var e=fs.readdirSync(t);return s=s||[],e.forEach(function(e){fs.statSync(path.join(t,e)).isDirectory()?s=walkSync(path.join(t,e),s,o):o.test(t+"/"+e)||s.push({dir:t.hackSlashes(),path:(t+"/"+e).hackSlashes(),fileName:e})}),s};function translateAliassesInArgs(e,t){var s,o=[];return e.forEach(function(e){(s=/^-([^\-]+)$/.exec(e))?o.push("--"+t[s[1]]):o.push(e)}),o}function getSliceOfMatchingOptions(e,t){var s=0,o=0;try{e.forEach(function(e){if(!new RegExp("^--("+t+")$","g").test(e)){if(s!=o)throw{};s++}o++})}catch(e){}return e.slice(s,o)}function metAllArgs(e){var t=getSliceOfMatchingOptions(translateAliassesInArgs(process.argv,SERVICES),ALL_SERVICES_OPTIONS),o="";t.forEach(function(e,t){var s=new RegExp("^--(.*)$","g").exec(e)[1];0!=t&&(o+="|"),o+=s});var s=!1;for(var i in e){var n=e[i];if(!new RegExp("^("+o+")$","g").test(n)){s=!0;break}}return!s}function tasksToRunOnArgvs(){var t=[],s=[],e=0,o=translateAliassesInArgs(process.argv,SERVICES),i=getSliceOfMatchingOptions(o,GLOUPS_OPTIONS);getSliceOfMatchingOptions(o,SERVICES_ADVANCED_OPTIONS);for(var n in i){try{n=/^[\-][\-]?([^\-]+)$/.exec(i[n])[1],new RegExp("^\\b("+PRESET_OPTIONS+")\\b$").test(n)?(checkPresetsOverdose(++e,n),t=SERVICES[n].split(" ")):t.push(SERVICES[n])}catch(e){if(s.push(e+" Error with option: "),/^GRAVE ERROR.*$/.test(e)){t=[];break}}e++}return logErrorsOnTaskArgvs(s),t}function checkPresetsOverdose(e,t){if(1<e)throw"GRAVE ERROR: Presets should be alone : "+t}function breath(){return"           "}function logFilePath(e){return"'{0}'".format([chalk.cyan(e)])}function logHelp(){var e,t,s=fs.readFileSync("help.md","utf8"),o=new classReading;o.initialize(s,0);var i=0;console.log("\n\n"),o.readLines(function(){t=o.getLine().replace(/\r?\n|\r/g,""),(e=/^([\s]*[#]+.*)$/.exec(t))?console.log(chalk.cyan(e[1])):(e=/^([\s]*)([$](?:[\s][^\s]+)+)([\s]{2,}.*|.*)$/.exec(t))?console.log("{0}{1}{2}".format([chalk.grey(e[1]),e[2],chalk.green(e[3])])):(e=/^([\s]*[>].*)$/.exec(t))?console.log(chalk.green(e[1])):(e=/^([\s]*)([\-]+[^\s,]+)([^\-.]*)((?:[\s][\-]+[^\s]+)+)([^\-.]*)((?:[.][^.\s]+)+|)([^\-.]*)((?:[.][^.\s]+)+|)(.*)$/.exec(t))?console.log("{0}{1}{2}{3}{4}{5}{6}{7}{8}".format([chalk.grey(e[1]),e[2],chalk.grey(e[3]),e[4],chalk.grey(e[5]),chalk.magenta(e[6]),chalk.grey(e[7]),chalk.magenta(e[8]),chalk.grey(e[9])])):(e=/^([^\-]*)((?:[\-]+[^\s]+[\s]?)+)([\s]?.*)$/.exec(t))?console.log("{0}{1}{2}".format([chalk.grey(e[1]),e[2],chalk.grey(e[3])])):0<t.length?console.log(chalk.grey(t)):++i%3==2&&console.log(t),0<t.length&&(i=0)})}function logErrorsOnTaskArgvs(e){0<e.length&&console.log("{0}\n{1}\n{2}\n{3}".format(chalk.red(e.join("\n"))),["WARNING \n\nYou may have made mistakes in shoosing wrong options.","call the folowing command to have more info of what options are valid","gulp --help"])}function logProjectErrored(e){console.log("{0}  - SOMETING IS WRONG\n    {1}\n    {2} {3}\n{4}\n{5}\n    > {6}".format([chalk.red(e.project),"this project seems to have no configuration .INI file defined",logFilePath(e.path+"\\config.mzg.ini"),chalk.red(": MISSING"),"SOLUTION:","run the command to setup projects local configuraitons:",chalk.grey("$ gulp scanProjects")]))}function logProcessCompleteOnFile(e,t,s){try{var o=new Date;s();var i=ms2Time(new Date-o);1<e.length?(console.log(forNowShortLog("{0} of these files:\n".format([t]))),e.forEach(function(e){console.log(logFilePath(e))}),console.log(),console.log(forNowShortLog("after {0}".format([chalk.magenta(i)])))):console.log(forNowShortLog("{0} {1} after {2}".format([logFilePath(e),t,chalk.magenta(i)])))}catch(e){console.log(chalk.red(e))}}function ms2Time(e){var t,s,o;return[(o=Math.floor((s=Math.floor((t=Math.floor((e=Math.floor(e%1e3))/1e3%60))%60))%24))?o+"h ":"",s?s+"min ":"",t?t+"sec ":"",e,"ms"].join("")}function dateComputed(){var e=new Date;return[["Mon","Tues","Wednes","Thirth","Fri","Satur","Sun"][e.getDay()-1],"day,",[e.getMonth()+1,e.getDate(),e.getFullYear()].join("-")].join("")}function timeComputed(){var e=new Date;return[e.getHours(),e.getMinutes(),e.getSeconds()].join(":")}function forNowLongLog(e,t){return"[{0}] {1}".format([chalk.gray(dateComputed()),e.format(t)])}function forNowShortLog(e,t){var s=e.format(t);return"[{0}] {1}".format([chalk.gray(timeComputed()),s])}function logServiceActivatedPushed(e,t,s){if(config.verbose){var o;(o=/^([^.]+)([.][^\s]*)([^.]+)([.][^\s]*)([^.]+)$/.exec(e))?console.log("{0}{1}{2}{3}{4}".format([chalk.grey(o[1]),chalk.magenta(o[2]),chalk.grey(o[3]),chalk.magenta(o[4]),chalk.grey(o[5])])):(o=/^([^.]+)([.][^\s]*)([^.]+)$/.exec(e))&&console.log("{0}{1}{2}".format([chalk.grey(o[1]),chalk.magenta(o[2]),chalk.grey(o[3])])),console.log("Watch :{0} - Dest. :{1}".format([logFilePath("[..]/"+s.watch),logFilePath("[..]/"+s.dest)]));var i=s.sourcemaps;void 0!==i&&console.log(i?chalk.green("Sourcemaps !"):chalk.grey("no sourcemaps"))}}function logTaskPurpose(e){logTaskName(e);var t={setVars:"  Sets configuration variables \n  See the .INI file of project mapping to set Gloups ready to serve your projects here :\n  > "+logFilePath("custom/config.mzg.ini")+":\n",automin:"  Will uglify .js files matching the folowing path(s):\n",autodel:"  Delete "+logFilePath(".min.js orphan files")+" when "+logFilePath(".js files model")+" are deleted\n",typescript:"  Will compile .ts files matching the folowing path(s):\n",coffeescript:"  Will compile .coffee files matching the folowing path(s):\n",autominCss:"  Will compress .css files matching the folowing path(s):\n",less:"  Will compile .less files matching the folowing path(s):\n",sass:"  Will compile .sass files matching the folowing path(s):\n",scanProjects:"  Creates configuration file in every project root folder\n"};t[e]?(console.log(t[e]),logWatchList(e)):console.log(chalk.yellow("  no information provided \n"))}function logWatchList(e){var t={automin:config.pathesToJs,typescript:config.pathesToTs,coffeescript:config.pathesToCoffee,autominCss:config.pathesToStyle,less:config.pathesToStyleLess,sass:config.pathesToSass};t[e]&&(watchList(t[e]).forEach(function(e){console.log("    "+logFilePath(e))}),console.log())}function logTaskName(e){console.log("............................................................."),console.log("[Task] "+chalk.red(e)+":")}function logTaskEndUgly(e){console.log("      > which is uglyfied "+chalk.red("for performances")),e?console.log("  once: "+chalk.red("not watching specific files")+"\n"):console.log()}function logTaskEndBeauy(e){console.log("      > which is beautifull "+chalk.red("for debugging")+"\n"),e?console.log("  once: "+chalk.red("not watching specific files")+"\n"):console.log()}function getOneFeedBackForAll(e){return{files:[],txt:e,k:0}}function classReading(){this.line=null,this.data=null,this.iter=null,this.stopped=!1,this.initialize=function(e,t){this.data=e+" ",this.iter=t,this.line=[]},this.readLines=function(e){for(var t;!this.isStopped()&&(t=this.getNextChar());)/^[\n\r]$/g.test(t)||this.isEndReached()?(this.toLine(),e(this.getLine()),this.resetLine()):this.feed(t)},this.stop=function(){this.stopped=!0},this.isStopped=function(){return this.stopped},this.setIter=function(e){this.iter=e},this.setData=function(e){this.data=e},this.toLine=function(){this.line=this.line.join(""),this.line=this.line.replace(/^[\n\r]$/g,"")},this.resetLine=function(){this.line=[]},this.getIter=function(){return this.iter},this.getData=function(){return this.data},this.getLine=function(){return this.line},this.getNextChar=function(){return this.data[this.iter++]},this.isEndReached=function(){return!this.data[this.iter]},this.feed=function(e){this.line.push(e)}}