var GLOUPS_VERSION="6.0";process.title="Gloups "+GLOUPS_VERSION+" | Chears !";var gulp=require("gulp"),chalk=require("chalk"),M={autoprefixer:"gulp-autoprefixer",cleanCSS:"gulp-clean-css",clear:"clear",coffee:"gulp-coffee",concat:"gulp-concat",del:"del",exit:"gulp-exit",fs:"fs",fssync:"fs-sync",insert:"gulp-insert",jsValidate:"gulp-jsvalidate",lazyPipe:"lazypipe",less:"gulp-less",nop:"gulp-nop",path:"path",rename:"gulp-rename",replace:"gulp-replace",sass:"gulp-sass",sourcemaps:"gulp-sourcemaps",stylefmt:"gulp-stylefmt",stylus:"gulp-stylus",through:"through2",ts:"gulp-typescript",uglify:"gulp-uglify",wait:"gulp-wait"},SERVICES={mj:"minjs",minjs:"automin",ts:"typescript",c:"coffee",coffee:"coffeescript",l:"less",less:"less",s:"sass",sass:"sass",sts:"stylus",stylus:"stylus",mc:"mincss",mincss:"autominCss",tr:"transitive",es:"essential",a:"all",all:"automin typescript coffeescript autominCss less sass stylus",st:"style",style:"autominCss less sass stylus",jvs:"javascript",javascript:"automin typescript coffeescript",tps:"typescript",typescript:"automin typescript",cof:"coffeescript",coffeescript:"automin coffeescript"},PRESET_OPTIONS="all|style|jvs|typescript|coffeescript",SERVICES_OPTIONS="minjs|ts|coffee|less|sass|stylus|mincss",SERVICES_ADVANCED_OPTIONS="transitive|essential",ALL_SERVICES_OPTIONS=PRESET_OPTIONS+"|"+SERVICES_OPTIONS+"|"+SERVICES_ADVANCED_OPTIONS,JS_REGEX_FILE_PATH_PATTERN="^(?:((?:[^\\.]+|..)[\\x2F\\x5C])|)((?:([^\\.^\\x2F^\\x5C]+)(?:((?:[.](?!\\bmin\\b)(?:[^\\.]+))+|))(?:([.]min)([.]js)|([.]js))))$",GLOUPS_OPTIONS=SERVICES_OPTIONS+"|"+PRESET_OPTIONS,SILENT_TASKS="watch|vet|unit-test|integration-test",ISALL=!0,isdist={},AUTOPREFIXER_BROWSERS=["> 1%","last 2 versions","firefox >= 4","safari 7","safari 8","IE 8","IE 9","IE 10","IE 11"],DEFAULT_CONFIG={verbose:!1,pathesToJs:[],pathesToTs:[],pathesToCoffee:[],pathesToStyle:[],pathesToStyleLess:[],pathesToSass:[],pathesToStylus:[],projects:[]},config=getConfig(),glob_found_modules={fs:!0},glob_visited_elements={infunc:{},intask:{}};String.prototype.format=function(s){return this.replace(String.prototype.format.regex,function(e){var t=parseInt(e.substring(1,e.length-1));return 0<=t?s[t]:-1===t?"{":-2===t?"}":""})},String.prototype.format.regex=new RegExp("{-?[0-9]+}","g"),String.prototype.hackSlashes=function(){return this.replace(/[\\]/g,"/")};var cmd=String(process.argv[2]);if(ISALL||new RegExp("^(({0})(:.*)?)$".format([SILENT_TASKS])).test(cmd)){var isWatching=/^(watch:.*)$/.test(cmd),firstCall=!1,on=gulp.on;gulp.on=function(e,t){if(!/^(task_start|task_stop)$/.test(e)||!/gutil\.log\(\s*'(Starting|Finished)/.test(t.toString()))return on.apply(gulp,arguments)},gulp.on("start",function(){firstCall&&(isWatching&&process.stdout.write("c"),firstCall=!1)}),gulp.on("stop",function(){firstCall=!0})}function getModule(e){if("string"==typeof e)for(var t in M)if(M[t]==e){var s=new Date;M[t]=require(e);var o=ms2Time(new Date-s);return isdist.NOT_DISTRIBUTION&&console.log(forNowShortLog(" {0}{1} loaded after {2}".format([chalk.bgMagenta(" M:"),chalk.bgMagenta(e+" "),chalk.magenta(o)]))),M[t]}return e}var logOrig=console.log;function gloupslog(e){logOrig(e)}var mayLogEssentials=metAllArgs(["essential"]);function runTaskProcessForCompression(e,o,n){logTaskPurpose(e.currentTask.name);var i=createMainLazyPipeObject(o,"Compressed    ",n.module),t=watchList(o);gulp.watch(t,function(e){var t=e.path;if(checkMultipleRules(t,["deleted"!==e.type].concat(n.rules))){var s=getMatchingEntryConfig(i.forMatchingObj.path=t,o);i.pathesDescr=s,i.process=n.mainPipe,consumePipeProcss(null,i,[t])}})}function runTaskProcessForPrecompiledFiles(e,n,i){logTaskPurpose(e.currentTask.name);var a=createMainLazyPipeObject(n,"Processed     ",i.module),t=watchList(n),r=getFreshTransitivity();gulp.watch(t,function(e){var t=e.path;if(checkMultipleRules(t,i.rules)){var s=getMatchingEntryConfig(a.forMatchingObj.path=t,n);a.process=i.mainPipe;var o=i.realTargetsFunction(t,s);consumePipeProcss(r,a,o)}})}function consumePipeProcss(e,t,s){var o=transitiveAndSourcemappingWrap(e,t);t.destCallBack=function(){return gloupslog(""),logChangedRealTargetedFiles(t,s),null!=e?e.dest:t.pathesDescr.dest},gulp.src(s).pipe(o()).pipe(gulp.dest(t.destCallBack()))}function logChangedRealTargetedFiles(e,t){var s,o=e.forMatchingObj.pathesDescr,n=e.message.action;if(cpt=0,1<t.length)t.forEach(function(e){0<cpt++&&(n="              "),s=getProjectNameWithFileFromPathDesc(o,e),gloupslog(" {0} '{1}{2}'".format([n,chalk.bgCyan(" "+s.projectName+" "),chalk.cyan(s.fileName+" ")]))});else{var i=t[0].hackSlashes();s=getProjectNameWithFileFromPathDesc(o,i),gloupslog(" {0} '{1}{2}'".format([n,chalk.bgCyan(" "+s.projectName+" "),chalk.cyan(s.fileName+" ")]))}}function getProjectNameWithFileFromPathDesc(e,t){var s=/[^\/\\]*(\/.*)/.exec(t)[1];s=".."+s;var o,n="<PROJECT NM>";for(var i in e){var a,r=e[i].projectPath.split("/").join("\\/")+"(.*)$";if(a=new RegExp(r,"g").exec(s)){n=e[i].projectName,o=a[1];break}}return{projectName:n,fileName:o}}function transitiveAndSourcemappingWrap(e,t){var s=t.process,o=t.forMatchingObj,n=o.path,i=o.pathesDescr,a=t.message,r=getMatchingEntryConfig(n,i);return setSourceMappingAndSign(transitiveWrapAround(e,r,n,s),r,a)}function setSourceMappingAndSign(e,t,s){var o=t.sourcemaps;return getModule(M.lazyPipe)().pipe(o?getModule(M.sourcemaps).init:getModule(M.nop)).pipe(e).pipe(insertSignatureAfter,s.action,s.module).pipe(o?function(){return getModule(M.sourcemaps).write("./")}:getModule(M.nop))}function transitiveWrapAround(e,t,s,o){null!=e&&"draft"==e.dest&&transitivitySetupCore(e,t,s);var n=null!=e?getModule(M.lazyPipe)().pipe(transitivitySetup,e,t,s):getModule(M.nop),i=null!=e?getModule(M.lazyPipe)().pipe(e.compressing).pipe(e.suffixing):getModule(M.nop);return getModule(M.lazyPipe)().pipe(n).pipe(o).pipe(i)}function transitivitySetup(o,n,i){return getModule(M.through).obj(function(e,t,s){transitivitySetupCore(o,n,i),s(null,e)})}function transitivitySetupCore(e,t,s){var o=metAllArgs(["all","transitive"])||metAllArgs(["sass","mincss","transitive"])||metAllArgs(["stylus","mincss","transitive"])||metAllArgs(["less","mincss","transitive"])||metAllArgs(["coffee","minjs","transitive"])||metAllArgs(["typescript","minjs","transitive"]),n=!1;if(e.dest=t.dest,o){var i=/^.*[\/](.*)$/g.exec(s.hackSlashes())[1],a="{0}/{1}".format([t.dest,i]),r=/.*[.](coffee|ts)$/.test(i)?"JS":/.*[.](scss|styl|less)$/.test(i)?"CSS":"UNDEFINED",l=getMatchingEntryConfig(a,"JS"==r?config.pathesToJs:"CSS"==r?config.pathesToStyle:null);n=null!=l,(e.should=n)&&(e.compressing="JS"==r?getModule(M.uglify):"CSS"==r?cleanCssMinification:getModule(M.nop),e.suffixing=renameSuffixMin,e.dest=l.dest)}}function renameSuffixMin(){return getModule(M.rename)({suffix:".min"})}function cleanCssMinification(){return getModule(M.cleanCSS)({compatibility:"ie8"})}function insertSignatureAfter(e,t){return getModule(M.insert).append("\n/* -- {0} with Gloups {1} | using {2} -- */".format([e,GLOUPS_VERSION,t]))}function autoprefix(){return getModule(M.autoprefixer)({browsers:AUTOPREFIXER_BROWSERS,cascade:!1})}function contains(e,t){for(var s=e.length;s--;)if(e[s]===t)return!0;return!1}function getMatchingPrincipalSCSS(e,t){var s=null;if((s=/^.*[\/\\](.*)$/.exec(t))&&s[1]&&/^_.*$/.test(s[1])){var o=(s=/^(.*[\\\/])_?(.*)[.].*$/g.exec(t))[1]+s[2],n=e.length,i=t.substr(n);ellipsedPath=pathEllipzizeing(o,0,i.split("/").length);var a=[],r=config.sassMaching;for(var l in r)contains(r[l].partials,ellipsedPath)&&a.push(r[l].target);return a}return[t]}function getFreshTransitivity(){return{should:!1,dest:"draft",compressing:getModule(M.nop),suffixing:getModule(M.nop)}}function createMainLazyPipeObject(e,t,s){return{process:null,destCallBack:function(){return gulp.dest("draft")},forMatchingObj:{path:null,pathesDescr:e},message:{action:t,module:s,files:[]}}}function checkMultipleRules(e,t,s){var o=t[s=null!=s?s:0],n=!0;if(null!=o)if("boolean"==typeof o)n=n&&!!o&&checkMultipleRules(e,t,++s);else if("object"==typeof o)if(o instanceof Array)"string"==typeof o[1]&&(o[1]=new RegExp(o[1],"g")),n="!"==o[0]&&!o[1].test(e);else{if(!(o instanceof RegExp))return gloupslog(chalk.red("undefined case ...")),!1;n=n&&!!n&&checkMultipleRules(e,t,++s)}else{if("string"!=typeof o)return gloupslog(chalk.red("undefined case ...")),!1;n=(n=new RegExp(o,"g").test(e))&&!!n&&checkMultipleRules(e,t,++s)}return n}function getConfig(){return config||DEFAULT_CONFIG}function readJsonConfig(e){var t,s,o=getModule(M.fs).readFileSync(e,"utf8"),n=new classReading;n.initialize(o,0);var i=0,a=!0,r="",l=(t=/^(.*)(\.json)$/.exec(e))[1]+".temp"+t[2],c=t[1]+"2.temp"+t[2];getModule(M.fssync).write(l,"","utf8"),n.readLines(function(){s=n.getLine(),(a=t=/^(.*)\/\/.*$/g.exec(s))?r=t[1]:(a=t=/^(.*)\/\*$/g.exec(s))?(r=t[1],++i):(a=t=/^.*\*\/(.*)$/g.exec(s))?(r=t[1],--i):(a=0==i)&&(r=s),a&&(/^[\s]*$/g.test(r)||(getModule(M.fs).appendFileSync(c,r+"\r\n","utf8"),getModule(M.fs).appendFileSync(l,/^[\s\t]*((?:[^\s\t]*[\s\t]*[^\s\t])+)[\s\t]*$/.exec(r)[1],"utf8")))});var g=getModule(M.fs).readFileSync(l,"utf8");return getModule(M.fssync).remove(l),getModule(M.fssync).remove(c),JSON.parse(g.replace(/}(,)]/g,"}]"))}function setConfig(){config.projects=readJsonConfig("custom/config.json").projects}function makePathesCoveringAllFilesFor(e,t,s,o){var n=t.addon,i=t.pathesToService;if(t.projectPath=e,n){for(var a=0,r=n.length;a<r;++a){n[a].watch=n[a].watch+s;n[a].watch,n[a].dest;0<a&&(o="[SAME-PURPOSE]");var l=getProjectNameFromRootPath(e);logServiceActivatedPushed(o,l,n[a]),n[a].watch=e+"/"+n[a].watch,n[a].dest=e+"/"+n[a].dest,n[a].projectPath=e,n[a].projectName=l,i=i.concat(n[a])}config.verbose&&console.log()}return i}function setUpProjectWatchingPaths(e){var t=readJsonConfig(e+"/config.mzg.json");console.log("Activated Services for target project under the path [FOLDER]:"),console.log(logFilePath(e)+"\n"),config.pathesToJs=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToJs,addon:t.minify_js},"/**/*.js","Compress .js files into .min.js files"),config.pathesToTs=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToTs,addon:t.ts_to_js},"/**/*.ts","Compile .ts files into .js file"),config.pathesToCoffee=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToCoffee,addon:t.coffee_to_js},"/**/*.coffee","Compile .coffee files into .js file"),config.pathesToStyle=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToStyle,addon:t.minify_css},"/**/*.css","Compress .css files"),config.pathesToStyleLess=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToStyleLess,addon:t.less},"/**/*.less","Compile .less files into .css files"),config.pathesToSass=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToSass,addon:t.sass},"/**/*.scss","Compile .scss files into .css files"),config.pathesToStylus=makePathesCoveringAllFilesFor(e,{pathesToService:config.pathesToStylus,addon:t.stylus},"/**/*.styl","Compile .styl files into .css files")}function getMatchingEntryConfig(e,t){for(var s in e=e.hackSlashes(),t){var o=t[s],n=o.watch.hackSlashes(),i=(o.dest.hackSlashes(),new RegExp("^([^\\\\/*]+).([^\\*]+)([\\/]?[\\/*]+[\\/]?)(.*)$","g").exec(n)[2]);if(new RegExp("^.*(?:"+i+").*$","g").exec(e))return o}return null}function watchList(e){var t=[];for(var s in e){var o=e[s].watch;t.push(o)}return t}function watchListLight(e){var n=[];return e.forEach(function(e){var t=e.watch,s=e.projectPath.length,o=t.substr(s);n.push({project:e.projectName,watch:o})}),n}function mappSassMatching(t,e){var s;if((s=/^(.*)[\\\/]\*\*[\\\/]\*\..*$/.exec(e))&&s[1]){config.sassMaching=[];var o=walkSync(s[1],[],new RegExp("^.*[\\/](_.*)$","i")),n=0;o.forEach(function(e){config.sassMaching.push({identifier:e.fileName,target:e.path,partials:[]}),pushEllipsizedPartials(t,e,n++)})}}function pushEllipsizedPartials(e,s,o){var n=new classReading,t=getModule(M.fs).readFileSync(s.path,"utf8");n.initialize(t,0);var i,a,r=e.length;n.readLines(function(){if(i=n.getLine(),(a=/^@import[\s].*["](.*)["]/.exec(i))&&a[1]){var e="{0}/{1}".format([s.dir,a[1]]),t=pathEllipzizeing(e,0,e.substr(r).split("/").length);config.sassMaching[o].partials.push(t)}})}function pathEllipzizeing(e,t,s){var o="^(?:(?:((?:[^/\\]+[\\/]{-1}1,2{-2}){-1}{0}{-2}).*((?:[\\/][^/\\?]+){-1}{1},{-2}[\\/]?)[^?]*).*|([^?]*).*)$".format([t,s]),n=new RegExp(o,"g").exec(e);return n[3]?n[3]:n[1]+"..."+n[2]}mayLogEssentials&&(console.log=function(){},gloupslog(forNowShortLog(chalk.bgRed(" Logging only essential messages ")))),gulp.task("default",["setParams"]),gulp.task("clear",function(){getModule(M.clear)()}),gulp.task("setVars",function(){for(var e in setConfig(),isdist.NOT_DISTRIBUTION&&getModule(M.path),config.verbose||logTaskPurpose(this.currentTask.name),config.projects){var t=config.projects[e];getModule(M.fssync).exists(t.path+"\\config.mzg.json")?(console.log(" "+chalk.bgGreen(" "+t.project+" ")),t.checked&&setUpProjectWatchingPaths(t.path)):logProjectErrored(t)}for(e in config.pathesToSass){var s=config.pathesToSass[e].watch;mappSassMatching(config.pathesToSass[e].projectPath,s)}isdist.NOT_DISTRIBUTION&&(config.verbose||console.log(forNowLongLog("{0}\n",["config externalized under config.json"])),gulp.start("externalizeConfig")),config.verbose||(console.log(forNowLongLog("{0}\n",["config externalized under config.json"])),console.log(forNowLongLog("{0}\n",["CONFIGURATON PROCEEDED"])))}),gulp.task("setParams",function(){var e,t=this.seq.slice(-1)[0];if(/^default$/.test(t))e=tasksToRunOnArgvs(),gulp.start(0<e.length?["setVars"].concat(e):[]);else if(/^serve$/.test(t))process.title="Gloups {0} | {1}".format([GLOUPS_VERSION,"Serve"]),e=tasksToRunOnArgvs(),isdist.NOT_DISTRIBUTION&&getAllNeededModules(e.concat(["setVars"])),gulp.start(0<e.length?["setVars"].concat(e):[]);else if(/^rewrite$/.test(t)){process.title="Gloups {0} | {1}".format([GLOUPS_VERSION,"Rewrite"]);var s=configurationOfRewriteOnArvs(),o=!/^ugly$/.test(s.uglyness),n=!/^multiple$/.test(s.times);isdist.NOT_DISTRIBUTION&&getAllNeededModules(["rewrite","writeTemp","writeDist","applyTemp","applyDist"]),logTaskName("rewrite {0}-{1} mode".format([o?"imBeauty":"imUgly",n?"one shot":"watching"])),mergingOnChanges(o,n),(o?logTaskEndBeauty:logTaskEndUgly)(n)}}),gulp.task("jshint",function(){return gulp.src(config.pathesToJs).pipe(jshint()).pipe(jshint.reporter("jshint-stylish"))}),gulp.task("helpMe",function(){logHelp()}),gulp.task("scanProjects",function(){logTaskPurpose(this.currentTask.name),setConfig(),config.projects.forEach(function(e){getModule(M.fssync).exists(e.path+"\\config.mzg.json")||(console.log("file :"+logFilePath(e.path+"\\config.mzg.json")+" does not exist ... creation very soon"),gulp.src("custom/config_model.json").pipe(getModule(M.rename)("config.mzg.json")).pipe(gulp.dest(e.path)))})}),gulp.task("serviceMapping",function(){logTaskPurpose(this.currentTask.name),config.verbose=!0,gulp.start(["setVars"])}),gulp.task("serve",["setParams"]),gulp.task("automin",function(){var e={module:"gulp-uglify",rules:[JS_REGEX_FILE_PATH_PATTERN,["!",/.*.min.js$/]],mainPipe:getModule(M.lazyPipe)().pipe(getModule(M.uglify)).pipe(renameSuffixMin)};runTaskProcessForCompression(this,config.pathesToJs,e)}),gulp.task("typescript",function(){var e={module:"gulp-typescript",rules:[/.*.ts$/],mainPipe:getModule(M.lazyPipe)().pipe(function(){return getModule(M.ts)({noImplicitAny:!0})}),realTargetsFunction:function(e,t){return[e]}};runTaskProcessForPrecompiledFiles(this,config.pathesToTs,e)}),gulp.task("coffeescript",function(){var e={module:"gulp-coffee",rules:[/.*.coffee$/],mainPipe:getModule(M.lazyPipe)().pipe(function(){return getModule(M.coffee)({bare:!0})}),realTargetsFunction:function(e,t){return[e]}};runTaskProcessForPrecompiledFiles(this,config.pathesToCoffee,e)}),gulp.task("autominCss",function(){var e={module:"gulp-clean-css",rules:[/^.*.css$/,["!",/^(?:.*.min.css|.*.less|.*.scss|.*.map)$/]],mainPipe:getModule(M.lazyPipe)().pipe(autoprefix).pipe(cleanCssMinification).pipe(renameSuffixMin)};runTaskProcessForCompression(this,config.pathesToStyle,e)}),gulp.task("autoformatCss",function(){gulp.watch(config.pathesToStyleLess,function(e){/^(.*.min.css)$/.test(e.path)||(console.log("try"),gulp.src(e.path).pipe(cssbeautify({format:"beautify"})).pipe(gulp.dest(function(e){return e.base})),console.log("done"))})}),gulp.task("less",function(){var e={module:"gulp-less",rules:[/.*.less$/],mainPipe:getModule(M.lazyPipe)().pipe(function(){return getModule(M.less)({paths:[getModule(M.path).join(__dirname,"less","includes")]})}).pipe(autoprefix).pipe(getModule(M.stylefmt)),realTargetsFunction:function(e,t){return[e]}};runTaskProcessForPrecompiledFiles(this,config.pathesToStyleLess,e)}),gulp.task("sass",function(){var e={module:"gulp-sass",rules:[/.*.scss$/],mainPipe:getModule(M.lazyPipe)().pipe(function(){return getModule(M.sass)({indentedSyntax:!1}).on("error",getModule(M.sass).logError)}).pipe(autoprefix).pipe(getModule(M.stylefmt)),realTargetsFunction:function(e,t){return getMatchingPrincipalSCSS(t.projectPath,e.hackSlashes())}};runTaskProcessForPrecompiledFiles(this,config.pathesToSass,e)}),gulp.task("stylus",function(){var e={module:"gulp-stylus",rules:[/.*.styl$/],mainPipe:getModule(M.lazyPipe)().pipe(function(){return getModule(M.stylus)({"include css":!0,linenos:!0})}).pipe(autoprefix).pipe(getModule(M.stylefmt)),realTargetsFunction:function(e,t){return[e]}};runTaskProcessForPrecompiledFiles(this,config.pathesToStylus,e)}),gulp.Gulp.prototype.__runTask=gulp.Gulp.prototype._runTask,gulp.Gulp.prototype._runTask=function(e){this.currentTask=e,this.__runTask(e)};var walkSync=function(t,s,o){var e=getModule(M.fs).readdirSync(t);return s=s||[],e.forEach(function(e){getModule(M.fs).statSync(getModule(M.path).join(t,e)).isDirectory()?s=walkSync(getModule(M.path).join(t,e),s,o):o.test(t+"/"+e)||s.push({dir:t.hackSlashes(),path:(t+"/"+e).hackSlashes(),fileName:e})}),s};function getProjectNameFromRootPath(e){var t=getConfig().projects;for(var s in t)if(e==t[s].path)return t[s].project;return e}function translateAliassesInArgs(e,t){var s,o=[];return e.forEach(function(e){(s=/^-([^\-]+)$/.exec(e))?o.push("--"+t[s[1]]):o.push(e)}),o}function getSliceOfMatchingOptions(e,t){var s=0,o=0;try{e.forEach(function(e){if(!new RegExp("^--("+t+")$","g").test(e)){if(s!=o)throw{};s++}o++})}catch(e){}return e.slice(s,o)}function metAllArgs(e){var t=getSliceOfMatchingOptions(translateAliassesInArgs(process.argv,SERVICES),ALL_SERVICES_OPTIONS),o="";t.forEach(function(e,t){var s=new RegExp("^--(.*)$","g").exec(e)[1];0!=t&&(o+="|"),o+=s});var s=!1;for(var n in e){var i=e[n];if(!new RegExp("^("+o+")$","g").test(i)){s=!0;break}}return!s}function tasksToRunOnArgvs(){var t=[],s=[],e=0,o=translateAliassesInArgs(process.argv,SERVICES),n=getSliceOfMatchingOptions(o,GLOUPS_OPTIONS);getSliceOfMatchingOptions(o,SERVICES_ADVANCED_OPTIONS);for(var i in n){try{i=/^[\-][\-]?([^\-]+)$/.exec(n[i])[1],new RegExp("^\\b("+PRESET_OPTIONS+")\\b$").test(i)?(checkPresetsOverdose(++e,i),t=SERVICES[i].split(" ")):t.push(SERVICES[i])}catch(e){if(s.push(e+" Error with option: "),/^GRAVE ERROR.*$/.test(e)){t=[];break}}e++}return logErrorsOnTaskArgvs(s),t}function checkPresetsOverdose(e,t){if(1<e)throw"GRAVE ERROR: Presets should be alone : "+t}function breath(){return"           "}function logFilePath(e){return"'{0}'".format([chalk.cyan(e)])}function logHelp(){var e,t,s=getModule(M.fs).readFileSync("help.md","utf8"),o=new classReading;o.initialize(s,0);var n=0;console.log("\n\n"),o.readLines(function(){t=o.getLine().replace(/\r?\n|\r/g,""),(e=/^([\s]*[#]+.*)$/.exec(t))?console.log(chalk.cyan(e[1])):(e=/^([\s]*)([$](?:[\s][^\s]+)+)([\s]{2,}.*|.*)$/.exec(t))?console.log("{0}{1}{2}".format([chalk.grey(e[1]),e[2],chalk.green(e[3])])):(e=/^([\s]*[>].*)$/.exec(t))?console.log(chalk.green(e[1])):(e=/^([\s]*)([\-]+[^\s,]+)([^\-.]*)((?:[\s][\-]+[^\s]+)+)([^\-.]*)((?:[.][^.\s]+)+|)([^\-.]*)((?:[.][^.\s]+)+|)(.*)$/.exec(t))?console.log("{0}{1}{2}{3}{4}{5}{6}{7}{8}".format([chalk.grey(e[1]),e[2],chalk.grey(e[3]),e[4],chalk.grey(e[5]),chalk.magenta(e[6]),chalk.grey(e[7]),chalk.magenta(e[8]),chalk.grey(e[9])])):(e=/^([^\-]*)((?:[\-]+[^\s]+[\s]?)+)([\s]?.*)$/.exec(t))?console.log("{0}{1}{2}".format([chalk.grey(e[1]),e[2],chalk.grey(e[3])])):0<t.length?console.log(chalk.grey(t)):++n%3==2&&console.log(t),0<t.length&&(n=0)})}function logErrorsOnTaskArgvs(e){0<e.length&&console.log("{0}\n{1}\n{2}\n{3}".format(chalk.red(e.join("\n"))),["WARNING \n\nYou may have made mistakes in shoosing wrong options.","call the folowing command to have more info of what options are valid","gulp --help"])}function logProjectErrored(e){gloupslog(" {0}  - SOMETING IS WRONG".format([chalk.bgRed(" "+e.project+" ")])),console.log("\n    {0}\n    {1} {2}\n\n {3}\n {4}\n    > {5}\n\n".format(["this project seems to have no configuration .INI file defined",logFilePath(e.path+"\\config.mzg.ini"),chalk.red(": MISSING"),chalk.gray.inverse(" SOLUTION "),"    run the command to setup projects local configuraitons:",chalk.grey("$ gulp scanProjects")]))}function logProcessCompleteOnFile(e,t,s){try{var o=new Date;s();var n=ms2Time(new Date-o);1<e.length?(console.log(forNowShortLog("{0} of these files:\n".format([t]))),e.forEach(function(e){console.log(logFilePath(e))}),console.log(),console.log(forNowShortLog("after {0}".format([chalk.magenta(n)])))):console.log(forNowShortLog("{0} {1} after {2}".format([logFilePath(e),t,chalk.magenta(n)])))}catch(e){console.log(chalk.red(e))}}function ms2Time(e){var t,s,o;return[(o=Math.floor((s=Math.floor((t=Math.floor((e=Math.floor(e%1e3))/1e3%60))%60))%24))?o+"h ":"",s?s+"min ":"",t?t+"sec ":"",e,"ms"].join("")}function dateComputed(){var e=new Date;return[["Mon","Tues","Wednes","Thirth","Fri","Satur","Sun"][e.getDay()-1],"day,",[e.getMonth()+1,e.getDate(),e.getFullYear()].join("-")].join("")}function timeComputed(){var e=new Date;return[e.getHours(),e.getMinutes(),e.getSeconds()].join(":")}function forNowLongLog(e,t){return"[{0}] {1}".format([chalk.gray(dateComputed()),e.format(t)])}function forNowShortLog(e,t){var s=e.format(t);return"[{0}] {1}".format([chalk.gray(timeComputed()),s])}function logServiceActivatedPushed(e,t,s){if(config.verbose){var o;(o=/^([^.]+)([.][^\s]*)([^.]+)([.][^\s]*)([^.]+)$/.exec(e))?console.log("{0}{1}{2}{3}{4}".format([chalk.grey(o[1]),chalk.magenta(o[2]),chalk.grey(o[3]),chalk.magenta(o[4]),chalk.grey(o[5])])):(o=/^([^.]+)([.][^\s]*)([^.]+)$/.exec(e))&&console.log("{0}{1}{2}".format([chalk.grey(o[1]),chalk.magenta(o[2]),chalk.grey(o[3])])),console.log(" Watch :'{0}{1}'\n Dest. :'{2}{3}'".format([chalk.bgCyan(" "+t+" "),chalk.cyan("/"+s.watch+" "),chalk.bgCyan(" "+t+" "),chalk.cyan("/"+s.dest+" ")]));var n=s.sourcemaps;void 0!==n&&console.log(n?"         "+chalk.bgGreen(" Sourcemaps ! "):"")}}function logTaskPurpose(e){logTaskName(e);var t={setVars:"  Sets configuration variables \n  See the .INI file of project mapping to set Gloups ready to serve your projects here :\n  > "+logFilePath("custom/config.mzg.ini")+":\n",automin:"  Will uglify .js files matching the folowing path(s):\n",typescript:"  Will compile .ts files matching the folowing path(s):\n",coffeescript:"  Will compile .coffee files matching the folowing path(s):\n",autominCss:"  Will compress .css files matching the folowing path(s):\n",less:"  Will process .less files matching the folowing path(s):\n",sass:"  Will process .sass files matching the folowing path(s):\n",stylus:"  Will process .styl files matching the folowing path(s):\n",scanProjects:"  Creates configuration file in every project root folder\n"};t[e]?(console.log(t[e]),logWatchList(e)):console.log(chalk.yellow("  no information provided \n"))}function logWatchList(e){var t={automin:config.pathesToJs,typescript:config.pathesToTs,coffeescript:config.pathesToCoffee,autominCss:config.pathesToStyle,less:config.pathesToStyleLess,sass:config.pathesToSass,stylus:config.pathesToStylus};t[e]&&(watchListLight(t[e]).forEach(function(e,t){console.log("    '{0}{1}'".format([chalk.bgCyan(" "+e.project),chalk.cyan(e.watch+" ")]))}),console.log())}function logTaskName(e){console.log("\n {0}{1}\n".format([chalk.bgWhite.black(" T:"),chalk.bgWhite.black(e+" ")]))}function logTaskEndUgly(e){console.log("      > which is uglyfied "+chalk.red("for performances")),e?console.log("  once: "+chalk.red("not watching specific files")+"\n"):console.log()}function logTaskEndBeauty(e){console.log("      > which is beautifull "+chalk.red("for debugging")+"\n"),e?console.log("  once: "+chalk.red("not watching specific files")+"\n"):console.log()}function classReading(){this.line=null,this.data=null,this.iter=null,this.stopped=!1,this.initialize=function(e,t){this.data=e+" ",this.iter=t,this.line=[]},this.readLines=function(e){for(var t;!this.isStopped()&&(t=this.getNextChar());)/^[\n\r]$/g.test(t)||this.isEndReached()?(this.toLine(),e(this.getLine()),this.resetLine()):this.feed(t)},this.stop=function(){this.stopped=!0},this.isStopped=function(){return this.stopped},this.setIter=function(e){this.iter=e},this.setData=function(e){this.data=e},this.toLine=function(){this.line=this.line.join(""),this.line=this.line.replace(/^[\n\r]$/g,"")},this.resetLine=function(){this.line=[]},this.getIter=function(){return this.iter},this.getData=function(){return this.data},this.getLine=function(){return this.line},this.getNextChar=function(){return this.data[this.iter++]},this.isEndReached=function(){return!this.data[this.iter]},this.feed=function(e){this.line.push(e)}}
/* -- Provided with Gloups 5.7 | using gulp- uglify, replace, concat, insert -- */